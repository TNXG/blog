<span id="tnxg_swloading"><!-- 占位符好看么？ --></span>
<script>
    (async () => {
        if ('serviceWorker' in navigator) { //如果支持sw
            if (Number(window.localStorage.getItem('ChenBlogHelper_Set')) < 1) {
                window.localStorage.setItem('ChenBlogHelper_Set', 1)
                window.stop()
                const replacehtml = await fetch('https://npm.elemecdn.com/tnxg-resource@0.0.2/pages/swinstall.html')
                document.getElementById("tnxg_swloading").innerHTML = await replacehtml.text()
            }
            //注册sw
            navigator.serviceWorker.register(`/sw.js?time=${new Date().getTime()}`)//随机数,强制更新
                .then(async () => {
                    if (Number(window.localStorage.getItem('ChenBlogHelper_Set')) < 2) {
                        setTimeout(() => {
                            window.localStorage.setItem('ChenBlogHelper_Set', 2)
                            //window.location.search = `?time=${ranN(1, 88888888888888888888)}` //已弃用,在等待500ms安装成功后直接刷新没有问题
                            window.location.reload()//刷新,以载入sw
                        }, 500)//安装后等待500ms使其激活
                    }
                })
                .catch(err => console.error(`ChenBlogHelperError:${err}`))
        }
    })()
</script>
<script src="https://npm.elemecdn.com/tnxg-blog/assets/js/massage.js"></script>
<script src="https://npm.elemecdn.com/qexo-static@1.3.0/hexo/statistic/statistic.js"></script>
<script>
    loadStatistic("https://qexo.prts.top")
</script>